import{r as m,j as e,a as h}from"./index-fHfFvoBC.js";import{I as p}from"./indian-rupee-BkyBSinH.js";const u={PLC:["Siemens PLC","ABB PLC","Schneider PLC","Allen Bradley PLC"],Drives:["Siemens","ABB"],Motors:["Nord","Siemens"],"Power Items":["MCCB","MCB"],Cables:[],Sensors:[]},S=Object.keys(u);function f({onSuccess:c,product:a=null}){var g;const t=!!a,[s,d]=m.useState({name:(a==null?void 0:a.name)??"",category:(a==null?void 0:a.category)??"",subcategory:(a==null?void 0:a.subcategory)??"",description:(a==null?void 0:a.description)??"",price:(a==null?void 0:a.price)??"",photo:null}),l=n=>d(i=>({...i,[n.target.name]:n.target.value})),r=n=>{d(i=>({...i,photo:n.target.files[0]??null}))},w=async n=>{var i,b,j;n.preventDefault();try{const x=((i=u[s.category])==null?void 0:i.length)>0&&s.category!=="Sensors"&&s.category!=="Cables";if(x&&!s.subcategory){alert("Please select a subcategory.");return}if(t)await h.put(`/products/${a.id}`,{name:s.name,category:s.category,subcategory:x?s.subcategory:null,description:s.description,price:s.price});else{const o=new FormData;o.append("name",s.name),o.append("category",s.category),x&&o.append("subcategory",s.subcategory),o.append("description",s.description),o.append("price",s.price),s.photo&&o.append("photo1",s.photo),await h.post("/products",o)}c(),t||d({name:"",category:"",subcategory:"",description:"",price:"",photo:null})}catch(N){alert(((j=(b=N.response)==null?void 0:b.data)==null?void 0:j.error)||"Error")}},y=((g=u[s.category])==null?void 0:g.length)>0,C=y&&s.category!=="Sensors"&&s.category!=="Cables";return e.jsxs("form",{onSubmit:w,className:"space-y-4 rounded border p-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:t?"Edit Product":"Add Product"}),e.jsx("input",{name:"name",value:s.name,onChange:l,placeholder:"Name",required:!0,className:"w-full rounded border p-2"}),e.jsxs("select",{name:"category",value:s.category,onChange:n=>{l(n),d(i=>({...i,subcategory:""}))},required:!0,className:"w-full rounded border p-2",children:[e.jsx("option",{value:"",disabled:!0,children:"Select category"}),S.map(n=>e.jsx("option",{value:n,children:n},n))]}),y&&e.jsxs("select",{name:"subcategory",value:s.subcategory,onChange:l,className:"w-full rounded border p-2",required:C,children:[e.jsx("option",{value:"",disabled:!0,children:"Select subcategory"}),u[s.category].map(n=>e.jsx("option",{value:n,children:n},n))]}),e.jsx("textarea",{name:"description",value:s.description,onChange:l,placeholder:"Description",required:!0,className:"w-full rounded border p-2"}),e.jsx("input",{name:"price",type:"number",step:"0.01",value:s.price,onChange:l,placeholder:"Price",required:!0,className:"w-full rounded border p-2"}),!t&&e.jsx("input",{type:"file",accept:"image/*",onChange:r,className:"w-full"}),e.jsx("button",{type:"submit",className:"rounded bg-primary-500 px-4 py-2 text-white",children:t?"Update":"Save"})]})}function P({products:c,onUpdated:a}){const[t,s]=m.useState(null),d=async r=>{confirm("Delete this product?")&&(await h.delete(`/products/${r}`),a())},l=c.find(r=>r.id===t);return e.jsxs("div",{children:[e.jsxs("table",{className:"min-w-full bg-white shadow-md rounded",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-100 text-left",children:[e.jsx("th",{className:"px-4 py-2",children:"Name"}),e.jsx("th",{className:"px-4 py-2",children:"Category"}),e.jsx("th",{className:"px-4 py-2",children:"Subcat"}),e.jsx("th",{className:"px-4 py-2",children:"Price"}),e.jsx("th",{className:"px-4 py-2",children:"Actions"})]})}),e.jsx("tbody",{children:c.map(r=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"px-4 py-2",children:r.name}),e.jsx("td",{className:"px-4 py-2",children:r.category}),e.jsx("td",{className:"px-4 py-2",children:r.subcategory}),e.jsxs("td",{className:"px-4 py-2",children:["$",r.price]}),e.jsxs("td",{className:"px-4 py-2 space-x-2",children:[e.jsx("button",{onClick:()=>s(r.id),className:"text-blue-600",children:"Edit"}),e.jsx("button",{onClick:()=>d(r.id),className:"text-red-600",children:"Delete"})]})]},r.id))})]}),l&&e.jsx("div",{className:"mt-6",children:e.jsx(f,{product:l,onSuccess:()=>{a(),s(null)}})})]})}function v(){const[c,a]=m.useState([]);return m.useEffect(()=>{async function t(){try{const{data:s}=await h.get("/orders");a(Array.isArray(s)?s:[])}catch(s){console.error("Could not fetch orders",s),a([])}}t()},[]),c.length?e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Orders"}),c.map(t=>e.jsxs("div",{className:"rounded border p-4 shadow-sm",children:[e.jsxs("h3",{className:"mb-1 font-semibold",children:["Order #",t.id," – ",new Date(t.created_at).toLocaleString()]}),e.jsxs("p",{className:"mb-2 text-sm text-gray-700 leading-snug",children:["Placed by: ",e.jsx("span",{className:"font-medium",children:t.user_name??"—"})," (User ID: ",t.user_id??"N/A",")",e.jsx("br",{}),"Email: ",t.user_email??"—","  |   Phone: ",t.user_phone??"—"]}),e.jsxs("table",{className:"mb-3 w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b text-left",children:[e.jsx("th",{className:"py-1",children:"Product"}),e.jsx("th",{className:"py-1",children:"Qty"}),e.jsx("th",{className:"py-1",children:"Unit Price"}),e.jsx("th",{className:"py-1",children:"Subtotal"})]})}),e.jsx("tbody",{children:t.items.map(s=>e.jsxs("tr",{className:"border-b last:border-0",children:[e.jsx("td",{className:"py-1",children:s.name}),e.jsx("td",{className:"py-1",children:s.qty}),e.jsxs("td",{className:"py-1",children:[e.jsx(p,{className:"inline h-4 w-4"}),s.price]}),e.jsxs("td",{className:"py-1",children:[e.jsx(p,{className:"inline h-4 w-4"}),(s.qty*s.price).toFixed(2)]})]},s.product_id))})]}),e.jsxs("div",{className:"text-right font-bold",children:["Total: ",e.jsx(p,{className:"inline h-4 w-4"}),t.total]})]},t.id))]}):e.jsx("p",{className:"text-sm text-gray-500",children:"No orders yet."})}function q(){const[c,a]=m.useState("add"),[t,s]=m.useState([]);m.useEffect(()=>{async function l(){try{const{data:r}=await h.get("/products");s(r)}catch(r){console.error("Failed loading products",r)}}l()},[]);const d=async()=>{const{data:l}=await h.get("/products");s(l)};return e.jsxs("div",{className:"mx-auto max-w-6xl p-4",children:[e.jsxs("div",{className:"mb-4 flex gap-4",children:[e.jsx("button",{onClick:()=>a("add"),className:c==="add"?"font-bold":"",children:"Add Product"}),e.jsx("button",{onClick:()=>a("manage"),className:c==="manage"?"font-bold":"",children:"Manage Products"}),e.jsx("button",{onClick:()=>a("orders"),className:c==="orders"?"font-bold":"",children:"Orders"})]}),c==="add"&&e.jsx(f,{onSuccess:d}),c==="manage"&&e.jsx(P,{products:t,onUpdated:d}),c==="orders"&&e.jsx(v,{})]})}export{q as default};
